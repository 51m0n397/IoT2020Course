<!DOCTYPE html>
<html>
<head>
  <title>Accelerometer test
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="UTF-8">
</head>
<body>
  <h1>Accelerometer raw data</h1>
  <button type="button" id="permission">Allow</button>
  <div id="status">No data</div>

  <script>
    document.getElementById("permission").addEventlistener('click', function () {
      DeviceMotionEvent.requestPermission().then(response => {
        if (response == 'granted') {
          window.addEventListener('devicemotion', (e) => {
            var accelerationX = e.accelerationIncludingGravity.x;
          	var accelerationY = e.accelerationIncludingGravity.y;
          	var accelerationZ = e.accelerationIncludingGravity.z;
            status.innerHTML = 'x: ' + accelerationX + '<br> y: ' + accelerationY + '<br> z: ' + accelerationZ;
          })
        }
      }).catch(console.error)
    });

    navigator.permissions.query({ name: 'accelerometer' })
    .then(result => {
      if (result.state === 'denied') {
        console.log('Permission to use accelerometer sensor is denied.');
        return;
      }
      let status = document.getElementById('status');
      if ( 'Accelerometer' in window ) {
        let sensor = new Accelerometer();
        sensor.addEventListener('reading', function(e) {
          status.innerHTML = 'x: ' + e.target.x + '<br> y: ' + e.target.y + '<br> z: ' + e.target.z;
        });
        sensor.start();
      }
      else status.innerHTML = 'Accelerometer not supported';
    });


  </script>

</body>
</html>
